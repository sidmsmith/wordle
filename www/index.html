<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>Wordle</title>
<meta name="theme-color" content="#121213">
<link rel="manifest" href="/manifest.json">
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;overflow:hidden}
body{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,"Helvetica Neue",Arial,sans-serif;background:#121213;color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;height:100vh;max-height:100vh;padding:clamp(3px,1vh,8px);overflow:hidden}
#game-container{display:flex;flex-direction:column;align-items:center;width:100%;max-width:500px;height:100%;justify-content:flex-start;gap:clamp(2px,0.8vh,6px);overflow:hidden}
h1{font-size:clamp(1.5rem,5vh,2.5rem);font-weight:700;letter-spacing:0.2em;margin:0;text-transform:uppercase;flex-shrink:0}
#board{display:grid;grid-template-columns:repeat(5,1fr);gap:clamp(3px,0.8vw,5px);margin:0;width:100%;max-width:min(350px,90vw);flex-shrink:0}
.tile{aspect-ratio:1;display:flex;align-items:center;justify-content:center;border:2px solid #3a3a3c;background:#121213;color:#fff;font-size:clamp(1.2rem,4.5vh,2rem);font-weight:700;text-transform:uppercase;transition:all 0.15s}
.tile.filled{border-color:#565758}
.tile.correct{background:#6aaa64;border-color:#6aaa64}
.tile.present{background:#c9b458;border-color:#c9b458}
.tile.absent{background:#3a3a3c;border-color:#3a3a3c}
.tile.flip{animation:flip 0.5s}
@keyframes flip{0%{transform:scaleY(1)}50%{transform:scaleY(0)}100%{transform:scaleY(1)}}
#message{min-height:clamp(30px,4vh,40px);text-align:center;font-size:clamp(0.875rem,2.5vh,1.2rem);margin:0;font-weight:600;flex-shrink:0}
#offline-status{min-height:18px;text-align:center;font-size:0.8rem;color:#9ca3af;margin-top:-2px;flex-shrink:0}
#new-game-btn{background:#6aaa64;color:#fff;border:none;padding:clamp(8px,2vh,12px) clamp(16px,4vw,24px);font-size:clamp(0.9rem,2.5vh,1.1rem);font-weight:600;border-radius:4px;cursor:pointer;margin:0;display:none;flex-shrink:0}
#new-game-btn:hover{background:#5a9a54}
#new-game-btn:active{transform:scale(0.98)}
#keyboard{display:flex;flex-direction:column;gap:clamp(4px,1vh,8px);width:100%;max-width:500px;padding:0 clamp(5px,2vw,10px);flex-shrink:0}
.keyboard-row{display:flex;justify-content:center;gap:clamp(4px,1vw,6px);width:100%}
.keyboard-key{flex:1;max-width:43px;height:clamp(36px,7vh,58px);display:flex;align-items:center;justify-content:center;background:#818384;color:#fff;border:none;border-radius:4px;font-size:clamp(0.7rem,2vh,0.875rem);font-weight:700;text-transform:uppercase;cursor:pointer;user-select:none;touch-action:manipulation;transition:all 0.1s}
.keyboard-key:active{transform:scale(0.95);opacity:0.8}
.keyboard-key.wide{flex:1.5;max-width:none}
.keyboard-key.extra-wide{flex:2;max-width:none}
.keyboard-key.correct{background:#6aaa64}
.keyboard-key.present{background:#c9b458}
.keyboard-key.absent{background:#3a3a3c}
</style>
</head>
<body>
<div id="game-container">
<h1>WORDLE</h1>
<div id="board"></div>
<div id="message"></div>
<div id="offline-status">Offline ready: checking...</div>
<button id="new-game-btn">New Game</button>
<div id="keyboard">
<div class="keyboard-row">
<div class="keyboard-key" data-key="Q">Q</div>
<div class="keyboard-key" data-key="W">W</div>
<div class="keyboard-key" data-key="E">E</div>
<div class="keyboard-key" data-key="R">R</div>
<div class="keyboard-key" data-key="T">T</div>
<div class="keyboard-key" data-key="Y">Y</div>
<div class="keyboard-key" data-key="U">U</div>
<div class="keyboard-key" data-key="I">I</div>
<div class="keyboard-key" data-key="O">O</div>
<div class="keyboard-key" data-key="P">P</div>
</div>
<div class="keyboard-row">
<div class="keyboard-key" data-key="A">A</div>
<div class="keyboard-key" data-key="S">S</div>
<div class="keyboard-key" data-key="D">D</div>
<div class="keyboard-key" data-key="F">F</div>
<div class="keyboard-key" data-key="G">G</div>
<div class="keyboard-key" data-key="H">H</div>
<div class="keyboard-key" data-key="J">J</div>
<div class="keyboard-key" data-key="K">K</div>
<div class="keyboard-key" data-key="L">L</div>
</div>
<div class="keyboard-row">
<div class="keyboard-key wide" data-key="ENTER">ENTER</div>
<div class="keyboard-key" data-key="Z">Z</div>
<div class="keyboard-key" data-key="X">X</div>
<div class="keyboard-key" data-key="C">C</div>
<div class="keyboard-key" data-key="V">V</div>
<div class="keyboard-key" data-key="B">B</div>
<div class="keyboard-key" data-key="N">N</div>
<div class="keyboard-key" data-key="M">M</div>
<div class="keyboard-key wide" data-key="BACKSPACE">âŒ«</div>
</div>
</div>
</div>
<script>
const WORDS=['aback','abaft','abase','abbey','abbot','abhor','abide','abler','abode','abort','about','above','absit','abuse','abuzz','abyss','ached','achoo','acorn','acted','actor','acute','adage','adapt','added','adder','adept','adieu','adlib','admit','admix','adobe','adopt','adore','adorn','adult','aerie','affix','afire','afoot','afore','afoul','after','again','agape','agate','agave','agent','agile','aging','aglow','agony','agora','agree','ahead','ahold','aided','aider','ailed','aimed','aimer','aioli','aired','airer','aisle','alarm','album','alder','alert','algae','alibi','alien','align','alike','alive','alkyl','allay','alley','allot','allow','alloy','aloft','aloha','alone','along','aloof','aloud','alpha','altar','alter','alway','amaze','amber','ambit','amble','amend','amigo','amino','amity','among','amour','amped','ample','amuck','amuse','angel','anger','angle','angry','angst','ankle','annex','annoy','annul','annum','anode','anted','antic','antsy','anvil','aorta','apace','apart','apnea','aport','apple','apply','apron','aptly','arbor','ardor','areal','arena','argon','argue','aries','arise','arity','armed','armor','aroma','arose','array','arrow','arson','artsy','ascot','ashen','aside','asked','asker','askew','aspen','assai','asset','aster','astir','astro','atilt','atoll','atone','attic','audio','audit','auger','aught','aural','avail','avant','avert','avian','avoid','await','awake','award','aware','awash','awful','awing','awoke','axial','axing','axiom','axled','axman','axmen','azure','babel','bacon','baddy','badge','badly','bagel','baggy','baked','baker','baldy','baled','baler','balky','bally','balmy','balsa','banal','bandy','banjo','bared','barer','barfy','barge','baric','barky','barmy','baron','basal','based','baser','basil','basin','batch','bated','bathe','baton','batty','bawdy','bayed','bayou','beach','beady','beaky','beamy','beard','beast','beaut','beaux','beech','beefy','beery','befit','began','begin','begot','begun','beige','being','belay','belch','belie','belle','belly','below','bench','beret','berry','berth','beset','bevel','bezel','bible','bided','bider','bidet','biggy','bigot','biked','biker','bilge','bimbo','binge','bingo','biome','birch','birth','bison','bitch','biter','bitsy','bitty','black','blade','blame','bland','blank','blare','blast','blaze','bleak','blear','bleat','bleed','blend','bless','blimp','blind','blink','blitz','bloat','block','bloke','blood','bloom','blown','blowy','blued','bluer','blues','bluff','blunt','blurb','blurt','blush','board','boast','bobby','bocce','bogey','boggy','bogie','boned','boner','bongo','booby','booed','boost','booth','booty','booze','boozy','borax','bored','borer','borne','boron','bosom','boson','bossy','botch','bough','bound','bowed','bowel','bower','bowie','boxed','boxer','brace','braid','brain','brake','brand','brant','brash','brass','brave','bravo','brawl','brawn','braze','bread','break','bream','breed','breve','briar','bribe','brick','bride','brief','brine','bring','brink','briny','brisk','broad','broil','broke','brood','brook','broom','broth','brown','bruin','brung','brunt','brush','brute','buddy','budge','buggy','bugle','build','built','bulge','bulky','bully','bumpy','bunch','bunko','bunny','burly','burnt','burro','burry','burst','bused','bushy','busty','butch','butte','buxom','buyer','buzzy','bylaw','byway','cabal','cabby','cabin','cable','cache','cacti','caddy','cadet','caged','cager','cagey','caked','camel','cameo','campy','canal','candy','canoe','canon','caped','caper','carat','cared','carer','caret','cargo','carne','carol','carom','carry','carve','cased','catch','caulk','cause','caved','cease','cedar','cello','chafe','chain','chair','chalk','champ','chant','charm','chart','chase','chasm','cheap','cheat','check','cheek','cheer','chess','chest','chewy','chick','chide','chief','child','chile','chili','chill','chime','chimp','china','chink','chirp','chive','choir','choke','chomp','chord','chore','chose','chuck','chump','chunk','churl','churn','chute','cider','cigar','cinch','circa','cited','civic','civil','clack','claim','clamp','clang','clank','clash','clasp','class','clean','clear','cleat','cleft','clerk','click','cliff','climb','cling','clink','cloak','clock','clone','close','cloth','cloud','clout','clove','clown','cluck','clued','clump','clung','clunk','coach','coast','cobra','cocky','cocoa','coded','coder','colon','color','combo','comet','comfy','comic','comma','conch','condo','coned','conic','cooed','cooky','coped','coral','cored','corer','corny','coset','costa','cotta','couch','cough','could','count','coupe','court','cover','covet','cower','crack','craft','cramp','crane','crank','crash','crass','crate','crave','crawl','craze','crazy','cream','creed','creek','creep','creme','crepe','crept','crest','cried','crier','crime','crimp','crisp','croak','crock','croft','crony','crook','cross','crowd','crown','crude','cruel','crumb','crush','crust','crypt','cubby','cubed','cubic','cupid','cuppy','cured','curly','curry','curse','curve','curvy','cushy','cuter','cycle','cynic','daddy','daily','dairy','daisy','dance','dandy','dared','darer','darky','dashy','dated','daunt','dazed','dealt','deary','death','debug','decaf','decal','decay','decor','decoy','decry','defer','deign','deity','delay','delta','delve','demon','denim','dense','depot','depth','derby','deter','deuce','devil','diary','diced','dicer','dicey','dicky','digit','dildo','dimly','dined','diner','dingo','dingy','diode','dirge','dirty','disco','ditch','ditto','divan','dived','diver','divot','dizzy','dodge','dodgy','doggy','dogma','doily','doing','dolly','domed','donor','donut','doped','dopey','dorky','dosed','doted','doubt','dough','douse','dowel','downy','dowry','dowse','dozed','dozen','dozer','draft','drain','drama','drank','drape','drawl','drawn','dread','dream','dress','dried','drier','drift','drill','drink','drive','droid','drone','drool','drove','drown','druid','drunk','dryer','ducky','dummy','dunce','duped','dusty','dutch','duvet','dwarf','dwell','dying','eager','eagle','early','earth','eased','easel','eaten','ebony','edged','edger','edict','eerie','egret','eight','eject','elate','elbow','elder','elect','elfin','elite','elope','elude','email','embed','emcee','emery','emote','empty','enact','endow','enema','enemy','enjoy','ensue','enter','entry','envoy','epoch','epoxy','epsom','equal','equip','erase','erect','erode','erred','error','erupt','essay','ether','ethic','etude','evade','event','every','evict','evoke','exact','exalt','excel','exert','exile','exist','expat','expel','extra','exude','fable','faced','facet','faded','faint','fairy','faith','faked','faker','famed','fancy','fanny','farce','fared','fatal','fated','fatly','fault','fauna','favor','faxed','fazed','feast','fecal','feign','feist','felon','femme','femur','fence','feral','ferry','fetal','fetch','fetid','fever','fewer','fiber','field','fiend','fiery','fifth','fifty','fight','filed','filer','filet','filly','filmy','filth','final','finch','fined','finer','fired','first','firth','fishy','fixed','fixer','fizzy','fjord','flack','flail','flair','flake','flaky','flame','flank','flare','flash','flask','fleck','fleet','flesh','flick','flied','flier','flies','fling','flint','flirt','float','flock','flood','floor','flora','floss','flour','flown','fluff','fluid','fluke','fluky','flume','flung','flunk','flush','flute','flyer','foamy','focal','foggy','folio','folky','folly','fondu','foray','force','forge','forgo','forte','forth','forty','forum','found','fount','foxed','foyer','frail','frame','frank','fraud','freak','freed','freer','fresh','friar','fried','frier','frill','frisk','frizz','frock','front','frost','froth','frown','froze','fruit','frump','fryer','fudge','fudgy','fugue','fully','fumed','fungi','funky','funny','furor','furry','fused','fussy','futon','fuzed','fuzzy','gabby','gable','gaffe','gamed','gamer','gamma','gamut','gaped','gaper','gassy','gated','gaudy','gauge','gaunt','gauze','gavel','gawky','gazed','gazer','gecko','geese','genie','genre','geode','ghost','ghoul','giant','giddy','gimpy','girly','girth','given','giver','gizmo','glade','gland','glare','glary','glass','glaze','gleam','glean','glide','glint','glitz','gloat','globe','gloom','glory','gloss','glove','glued','gluer','gnarl','gnash','gnome','godly','gofer','going','golly','gonad','goner','gonna','gonzo','goody','gooey','goofy','gooky','goopy','goose','gored','gorge','gouda','gouge','gourd','grace','grade','graft','grail','grain','grand','grant','grape','graph','grasp','grass','grate','grave','gravy','graze','great','greed','greek','green','greet','grief','grift','grill','grime','grimy','grind','gripe','groan','groin','groom','grope','gross','group','grout','grove','growl','grown','gruel','gruff','grump','grunt','guard','guava','guess','guest','guide','guild','guile','guilt','guise','gulag','gulch','gumbo','gummy','guppy','gushy','gusto','gusty','gutsy','gypsy','habit','haiku','hairy','haled','halve','handy','hanky','happy','harem','harsh','harum','haste','hasty','hatch','hated','hater','haunt','haven','havoc','hazed','hazel','heard','heart','heath','heave','heavy','hedge','hefty','heist','helix','hello','hence','henna','heron','hertz','hexed','hider','hiked','hiker','hilly','hinge','hippo','hippy','hired','hirer','hitch','hoagy','hoard','hobby','hoist','hokey','holed','holer','holey','holly','homed','homer','homey','honed','honey','honor','hooch','hooky','hoped','hoppy','horny','horse','hosed','hotel','hotly','hound','house','hover','howdy','hubby','huger','hulky','human','humid','humor','humpy','humus','hunch','hunky','hurry','husky','hutch','hydra','hydro','hyena','hyped','hyper','icier','icing','ideal','idiom','idiot','idled','idyll','igloo','image','imply','inane','inapt','incur','index','indie','inept','inert','infer','injun','inked','inlay','inlet','inner','input','inset','inter','intro','ionic','irate','irked','irony','islet','issue','itchy','ivory','jaded','jammy','japan','jaunt','jawed','jazzy','jello','jelly','jerky','jetty','jewel','jiffy','jihad','jived','joint','joist','joked','joker','jolly','joule','joust','joyed','judge','juice','juicy','jumbo','jumpy','junky','juror','kabob','kappa','karma','kayak','kazoo','kebab','keyed','khaki','kicky','kiddo','kinda','kinky','kiosk','kitty','klunk','klutz','knack','knead','kneed','kneel','knelt','knife','knock','known','koala','kooky','kraut','krill','kudzu','label','labia','labor','laced','laden','ladle','lager','laity','lanai','lance','lanky','lapel','lapse','large','largo','larva','laser','lasso','latch','later','latex','lathe','latin','laugh','layer','layup','lazed','leach','leafy','leaky','leapt','learn','lease','leash','least','leave','ledge','leech','leery','lefty','legal','leggy','legit','lemon','lemur','leper','letup','levee','level','lever','libel','libra','light','liked','liken','lilac','limbo','limey','limit','lined','linen','liner','lingo','lipid','liter','lived','liven','liver','livid','llama','loath','lobby','lobed','local','lodge','lofty','loggy','logic','login','loner','loopy','loose','loped','lorry','loser','lotto','louse','lousy','loved','lover','lower','lowly','loyal','lucid','lucky','lumen','lumpy','lunar','lunch','lunge','lurch','lured','lusty','lycra','lying','lymph','lynch','lyric','macaw','maced','macho','macro','madam','madly','mafia','magic','magma','magna','maize','major','maker','mambo','maned','mange','mango','mangy','mania','manic','manly','manor','manta','maple','march','marry','marsh','mason','masse','match','mated','matey','matte','matzo','mauve','maven','maxim','maybe','mayor','mazed','meant','meaty','mecca','medal','media','medic','melee','melon','mercy','merge','merit','merry','messy','metal','meter','metro','micro','midst','might','miked','milch','milky','mimic','mince','mined','miner','minor','mired','miser','missy','misty','miter','mixed','mixer','mixup','mocha','modal','model','modem','mogul','moist','molar','moldy','momma','mommy','money','month','mooch','moody','moose','moped','moral','moron','morph','mossy','motel','motif','motor','motto','mould','mound','mount','mourn','mouse','mouth','moved','mover','movie','mowed','mower','moxie','mucky','muddy','muggy','mulch','mumbo','mummy','munch','mural','murky','mused','mushy','music','musty','muted','muter','mylar','nacho','naive','naked','named','nanny','nappy','narco','nasal','nasty','natal','natch','naval','navel','needy','negro','nerdy','nerve','nervy','never','newer','newly','nicer','niche','niece','nifty','night','ninja','ninth','nippy','nisei','niter','nitro','nixed','noble','nobly','nodal','noise','noisy','nomad','noose','north','nosed','nosey','notch','noted','novel','nudge','nudie','nuked','nurse','nutty','nylon','nymph','oaken','obese','occur','ocean','ocher','ochre','octal','octet','odder','oddly','offer','often','ogled','oiled','oinky','okapi','olden','older','oldie','olive','omega','onion','onset','oodle','oomph','oozed','opera','opine','opium','opted','optic','orate','orbit','order','organ','ortho','other','otter','ought','ounce','outdo','outer','ovary','ovate','overt','owing','owned','owner','oxbow','oxide','ozone','paced','pacer','paddy','padre','pagan','paged','pager','paint','paled','paler','palsy','panda','paned','panel','panic','pansy','panty','papal','paper','parch','pared','parka','parse','party','passe','pasta','paste','pasty','patch','patio','patsy','patty','pause','paved','paver','pawed','payed','payee','payer','peace','peach','peaky','pearl','pecan','pedal','peeve','penal','penny','peony','peppy','perch','peril','perky','pesky','pesto','petal','petri','petty','phase','phone','phony','photo','piano','picky','piece','piety','piggy','pilaf','piled','pinch','pined','piney','pinky','pinto','pinup','piped','piper','pique','pitch','pivot','pixel','pixie','pizza','place','plaid','plain','plane','plank','plant','plate','plaza','plead','pleat','plebe','plied','pluck','plumb','plume','plump','plunk','plush','poach','point','poise','poked','poker','pokey','polar','poled','polio','polka','polyp','pooch','poppy','porch','porky','porno','posed','posse','potty','pouch','pound','power','prank','prawn','press','price','prick','pride','prime','primo','primp','print','prior','prism','privy','prize','probe','promo','prone','prong','proof','prose','proud','prove','prowl','proxy','prude','prune','psalm','psych','pubic','pudgy','puffy','puked','pulse','punch','punky','pupil','puppy','puree','purer','purge','purse','pushy','pussy','putty','pygmy','pylon','quack','quail','quake','qualm','quark','quart','quash','quasi','queen','queer','quell','query','quest','queue','quick','quiet','quill','quilt','quint','quirk','quirt','quite','quota','quote','rabbi','rabid','raced','racer','radar','radii','radio','raged','rainy','raise','raked','rally','ranch','randy','range','rangy','raped','rapid','rarer','raspy','rated','rater','ratio','ratty','raved','raven','raver','rayon','razed','razor','reach','react','ready','realm','rebel','recap','recur','refer','refit','regal','rehab','reign','relax','relay','relic','remit','remix','renal','renew','repay','repel','reply','rerun','reset','resin','retro','retry','reuse','revel','revue','rhino','rhyme','riced','rider','ridge','ridgy','rifle','right','rigid','rigor','riled','rinse','ripen','risen','riser','risky','ritzy','rival','river','rivet','roach','roast','robed','robin','robot','rocky','rodeo','rogue','roman','roomy','roost','roped','rosin','rotor','rouge','rough','round','rouse','route','roved','rover','rowdy','rowed','rower','royal','ruder','rugby','ruled','ruler','rumba','rummy','rumor','runny','rural','rusty','saber','sable','sadly','safer','saint','salad','sally','salon','salsa','salty','salvo','samba','sandy','saner','sappy','sassy','sated','satin','sauce','saucy','sauna','saute','saved','saver','savor','savvy','sawed','sayer','scald','scale','scalp','scaly','scamp','scant','scare','scarf','scary','scene','scent','scion','scoff','scold','scone','scoop','scoot','scope','score','scorn','scour','scout','scowl','scram','scrap','screw','scrub','scrum','scuba','scuff','seamy','sedan','seedy','segue','seize','sense','septa','serif','serum','serve','servo','setup','seven','sever','sewed','sewer','shack','shade','shady','shaft','shake','shaky','shale','shame','shank','shape','shard','share','shark','sharp','shave','shawl','shear','sheen','sheep','sheer','sheet','sheik','shelf','shell','shied','shift','shill','shine','shiny','shire','shirt','shoal','shock','shoed','shone','shook','shoot','shore','shorn','short','shout','shove','shown','showy','shred','shrew','shrub','shrug','shuck','shunt','shush','sided','siege','sieve','sight','sigma','silky','silly','silty','since','singe','sired','siren','sissy','sitar','sited','sixth','sixty','sized','sizer','skate','skeet','skied','skier','skies','skiff','skill','skimp','skirt','skull','skunk','slack','slain','slang','slant','slash','slate','slave','sleek','sleep','sleet','slept','slice','slick','slide','slime','slimy','sling','sloop','slope','slosh','sloth','slump','slung','slurp','slush','smack','small','smart','smash','smear','smell','smelt','smile','smirk','smith','smock','smoke','smoky','smurf','snack','snafu','snail','snake','snaky','snare','snarf','snark','snarl','sneak','sneer','snide','sniff','snipe','snoop','snoot','snore','snort','snout','snowy','snuck','snuff','soapy','sober','soggy','solar','solid','solve','sonar','sonic','sooth','soppy','sorer','sorry','sound','soupy','south','sowed','sower','space','spacy','spade','spake','spank','spare','spark','spasm','spate','spawn','speak','spear','speck','speed','spell','spend','spent','sperm','spice','spicy','spied','spiel','spies','spiff','spike','spiky','spill','spilt','spine','spiny','spire','spite','splat','splay','split','spoil','spoke','spoof','spook','spool','spoon','spore','sport','spout','sprat','spray','spree','sprig','sprit','spunk','spurn','spurt','squad','squat','squaw','squib','squid','stack','staff','stage','stain','stair','stake','stale','stalk','stall','stamp','stand','stank','staph','stare','stark','start','stash','stave','stead','steak','steal','steam','steel','steep','steer','stein','stern','stick','stiff','stile','still','stilt','sting','stink','stint','stock','stoic','stoke','stole','stomp','stone','stony','stood','stool','stoop','store','stork','storm','story','stout','stove','strap','straw','stray','strep','strew','strip','strum','strut','stuck','study','stuff','stump','stung','stunk','stunt','style','suave','sudsy','suede','sugar','suing','suite','sulky','sunny','sunup','super','surer','surge','surly','sushi','swain','swami','swamp','swank','swarm','swash','swath','swear','sweat','swede','sweep','sweet','swell','swept','swift','swine','swing','swipe','swirl','swish','swiss','swoon','swoop','sword','swore','sworn','swung','syrup','tabby','table','taboo','tacet','tacit','tacky','taffy','taint','taken','taker','tally','talon','tamed','tamer','tango','taped','taper','tapir','tardy','tarot','tarry','taste','tasty','tater','taunt','taupe','tawny','taxed','taxer','teach','teary','tease','techy','teddy','teeny','teeth','tempo','tempt','tenet','tenor','tense','tenth','tepee','tepid','terra','terse','tesla','testy','thank','thanx','theft','their','theme','there','therm','these','theta','thick','thief','thigh','thine','thing','think','third','thong','thorn','those','three','threw','throb','throe','throw','thrum','thumb','thump','thunk','thyme','tiara','tibia','tidal','tided','tiger','tight','tilde','tiled','tiler','timed','timer','timid','tinny','tippy','tipsy','tired','titan','title','titty','tizzy','toady','toast','today','toddy','toffy','token','tonal','toned','toner','tonic','tooth','topaz','topic','torah','torch','torso','torte','total','toted','totem','touch','tough','towed','towel','tower','toxic','toxin','toyed','toyer','trace','track','tract','trade','trail','train','trait','tramp','trash','trawl','tread','treat','trend','triad','trial','tribe','trick','tried','trier','trike','trill','tripe','trite','troll','tromp','troop','trout','trove','truce','truck','truer','truly','trump','trunk','truss','trust','truth','tryst','tubal','tubby','tubed','tuber','tulip','tummy','tumor','tuned','tuner','tunic','turbo','tutor','twang','tweak','tweed','tweet','twerp','twice','twill','twirl','twist','tying','typed','udder','ulcer','ulnar','ultra','umber','unarm','unbox','uncap','uncle','uncut','under','undid','unfit','unify','union','unite','unity','unsee','unset','untie','until','unzip','upend','upped','upper','upset','urban','urged','urger','urine','usage','usher','using','usual','usurp','utero','utter','uvula','vague','valet','valid','valor','value','valve','vaned','vapor','vault','vaunt','vegan','veiny','venal','venom','venue','verge','versa','verse','verve','vexed','vicar','video','vigil','vigor','villa','vinyl','viola','viper','viral','visit','visor','vista','vital','vitro','vivid','vixen','vizor','vocab','vocal','vodka','vogue','voice','voila','vomit','voted','voter','vouch','vowed','vowel','vroom','vulva','vying','wacko','wacky','waded','wader','wafer','waged','wager','wagon','waist','waive','waked','waken','waker','waled','waltz','waned','warty','washy','waste','watch','water','waved','waver','waxed','waxen','waxer','weary','weave','weber','wedge','wedgy','weedy','weepy','weigh','weird','welsh','wench','wetly','whack','whale','wharf','wheat','wheel','whelm','whelp','where','which','whiff','while','whine','whiny','whirl','whish','whisk','white','whole','whomp','whoop','whore','whose','widen','wider','widow','width','wield','wifey','wimpy','wince','winch','windy','wined','winey','wiped','wiper','wired','wirer','wised','wiser','witch','witty','woken','woman','women','wonky','woody','wooed','wooer','wooly','woosh','woozy','wordy','world','wormy','worry','worse','worst','worth','would','wound','woven','wowed','wrath','wreak','wreck','wring','wrist','write','wrong','wrote','wroth','wryly','wurst','xenon','xerox','yacht','yahoo','yawny','yearn','yeast','yield','yodel','yoked','yolky','young','yourn','youth','yucca','yucky','yummy','zebra','zesty','zilch','zingy','zippy','zoned'];
const WORD_LENGTH=5;
const MAX_GUESSES=6;
let targetWord="";
let currentGuess="";
let currentRow=0;
let gameOver=false;
let board=[];
let letterStates={};
let activeGame=null;
let isSyncInProgress=false;
let syncRetryMs=2000;
const MAX_SYNC_RETRY_MS=60000;

const STORAGE_KEYS={
  deviceId:"wordle_device_id",
  pendingQueue:"wordle_pending_queue"
};
const OFFLINE_CACHE_NAME="wordle-shell-v1";
const OFFLINE_SHELL_PREF_KEY="wordle_offline_shell_pref";
const IS_NATIVE_APP=true; // capacitor native build
const SYNC_API_URL=IS_NATIVE_APP
  ?"https://wordle-theta-red.vercel.app/api/wordle-sync"
  :"/api/wordle-sync";

function generateClientId(){
  if(window.crypto&&window.crypto.randomUUID){
    return window.crypto.randomUUID();
  }
  return `id_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;
}

function getDeviceId(){
  try{
    const existing=localStorage.getItem(STORAGE_KEYS.deviceId);
    if(existing)return existing;
    const created=generateClientId();
    localStorage.setItem(STORAGE_KEYS.deviceId,created);
    return created;
  }catch(e){
    return "browser_device_unavailable";
  }
}

function getPendingQueue(){
  try{
    const raw=localStorage.getItem(STORAGE_KEYS.pendingQueue);
    if(!raw)return [];
    const parsed=JSON.parse(raw);
    return Array.isArray(parsed)?parsed:[];
  }catch(e){
    return [];
  }
}

function setPendingQueue(queue){
  try{
    localStorage.setItem(STORAGE_KEYS.pendingQueue,JSON.stringify(queue));
  }catch(e){
    // Ignore storage errors and keep game playable.
  }
}

function enqueueCompletedGame(game){
  const queue=getPendingQueue();
  queue.push(game);
  setPendingQueue(queue);
}

function removeAcknowledgedGames(ackedIds){
  if(!ackedIds.length)return;
  const ackSet=new Set(ackedIds);
  const queue=getPendingQueue();
  const filtered=queue.filter(game=>!ackSet.has(game.client_game_id));
  setPendingQueue(filtered);
}

function createGameSession(){
  activeGame={
    client_game_id:generateClientId(),
    device_id:getDeviceId(),
    start_time:new Date().toISOString(),
    end_time:null,
    target_word:targetWord.toLowerCase(),
    outcome:null,
    guesses:[]
  };
}

function recordGuess(guess){
  if(!activeGame)return;
  activeGame.guesses.push(guess.toLowerCase());
}

function finalizeGame(outcome){
  if(!activeGame||activeGame.outcome)return;
  activeGame.outcome=outcome;
  activeGame.end_time=new Date().toISOString();
  activeGame.guesses_count=activeGame.guesses.length;
  enqueueCompletedGame(activeGame);
  activeGame=null;
  trySyncPendingGames();
}

function scheduleSyncRetry(){
  setTimeout(()=>{
    trySyncPendingGames();
  },syncRetryMs);
  syncRetryMs=Math.min(syncRetryMs*2,MAX_SYNC_RETRY_MS);
}

async function trySyncPendingGames(){
  if(isSyncInProgress)return;
  if(!navigator.onLine)return;

  const pendingGames=getPendingQueue();
  if(!pendingGames.length)return;

  isSyncInProgress=true;
  try{
    const response=await fetch(SYNC_API_URL,{
      method:"POST",
      headers:{
        "Content-Type":"application/json"
      },
      body:JSON.stringify({games:pendingGames})
    });

    if(!response.ok){
      throw new Error(`Sync failed with status ${response.status}`);
    }

    const payload=await response.json();
    const ackedIds=Array.isArray(payload.acked_ids)?payload.acked_ids:[];
    removeAcknowledgedGames(ackedIds);
    syncRetryMs=2000;
  }catch(error){
    scheduleSyncRetry();
  }finally{
    isSyncInProgress=false;
  }
}

function setOfflineStatus(text,color){
  const el=document.getElementById("offline-status");
  el.textContent=text;
  if(color){
    el.style.color=color;
  }
}

async function checkOfflineReadyStatus(){
  if(!("serviceWorker" in navigator)||!("caches" in window)){
    setOfflineStatus("Offline ready: unavailable on this browser","#f87171");
    return;
  }

  try{
    const cache=await caches.open(OFFLINE_CACHE_NAME);
    const requiredUrls=["/","/wordle.html","/wordle","/manifest.json","/wordle.png"];
    const checks=await Promise.all(requiredUrls.map(url=>cache.match(url)));
    const hasAllAssets=checks.every(Boolean);
    const hasController=Boolean(navigator.serviceWorker.controller);

    if(hasAllAssets&&hasController){
      setOfflineStatus("Offline ready: yes","#86efac");
    }else{
      setOfflineStatus("Offline ready: not yet (keep online briefly)","#fbbf24");
    }
  }catch(error){
    setOfflineStatus("Offline ready: check failed","#f87171");
  }
}

function getOfflineShellPreference(){
  const params=new URLSearchParams(window.location.search);
  const modeParam=params.get("offlineShell");
  const isStandalone=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches;

  if(modeParam==="on"){
    localStorage.setItem(OFFLINE_SHELL_PREF_KEY,"on");
  }else if(modeParam==="off"){
    localStorage.setItem(OFFLINE_SHELL_PREF_KEY,"off");
  }

  // Installed app context defaults to ON unless explicitly overridden in URL.
  if(isStandalone&&modeParam!=="off"){
    localStorage.setItem(OFFLINE_SHELL_PREF_KEY,"on");
  }

  return localStorage.getItem(OFFLINE_SHELL_PREF_KEY)==="on";
}

function initGame(){
  targetWord=WORDS[Math.floor(Math.random()*WORDS.length)];
  currentGuess="";
  currentRow=0;
  gameOver=false;
  board=[];
  letterStates={};
  document.getElementById("message").textContent="";
  document.getElementById("new-game-btn").style.display="none";
  const boardEl=document.getElementById("board");
  boardEl.innerHTML="";
  for(let i=0;i<MAX_GUESSES;i++){
    const row=[];
    for(let j=0;j<WORD_LENGTH;j++){
      const tile=document.createElement("div");
      tile.className="tile";
      boardEl.appendChild(tile);
      row.push(tile);
    }
    board.push(row);
  }
  updateKeyboard();
  createGameSession();
}

function updateKeyboard(){
  const keys=document.querySelectorAll(".keyboard-key[data-key]");
  keys.forEach(key=>{
    const letter=key.dataset.key;
    if(letter==="ENTER"||letter==="BACKSPACE")return;
    const isWide=key.classList.contains("wide");
    const isExtraWide=key.classList.contains("extra-wide");
    key.className="keyboard-key";
    if(isWide)key.classList.add("wide");
    if(isExtraWide)key.classList.add("extra-wide");
    if(letterStates[letter]){
      key.classList.add(letterStates[letter]);
    }
  });
}

function updateBoard(){
  const row=board[currentRow];
  for(let i=0;i<WORD_LENGTH;i++){
    row[i].textContent=currentGuess[i]||"";
    row[i].classList.toggle("filled",!!currentGuess[i]);
  }
}

function getTileState(guess,target){
  const states=Array(WORD_LENGTH).fill("absent");
  const targetCounts={};
  const guessCounts={};
  for(let i=0;i<WORD_LENGTH;i++){
    if(guess[i]===target[i])states[i]="correct";
    targetCounts[target[i]]=(targetCounts[target[i]]||0)+1;
  }
  for(let i=0;i<WORD_LENGTH;i++){
    if(states[i]==="correct"){
      guessCounts[guess[i]]=(guessCounts[guess[i]]||0)+1;
    }
  }
  for(let i=0;i<WORD_LENGTH;i++){
    if(states[i]!=="correct"){
      const letter=guess[i];
      const targetCount=targetCounts[letter]||0;
      const guessCount=guessCounts[letter]||0;
      if(target.includes(letter)&&guessCount<targetCount){
        states[i]="present";
        guessCounts[letter]=(guessCounts[letter]||0)+1;
      }
    }
  }
  return states;
}

function updateLetterStates(guess,states){
  for(let i=0;i<WORD_LENGTH;i++){
    const letter=guess[i].toUpperCase();
    const state=states[i];
    if(!letterStates[letter]||state==="correct"||(state==="present"&&letterStates[letter]!=="correct")){
      letterStates[letter]=state;
    }
  }
  updateKeyboard();
}

function submitGuess(){
  if(currentGuess.length!==WORD_LENGTH)return;
  if(!WORDS.includes(currentGuess.toLowerCase())){
    document.getElementById("message").textContent="Not in word list";
    setTimeout(()=>{
      document.getElementById("message").textContent="";
    },2000);
    return;
  }
  recordGuess(currentGuess.toLowerCase());
  const row=board[currentRow];
  const states=getTileState(currentGuess.toLowerCase(),targetWord);
  updateLetterStates(currentGuess,states);
  for(let i=0;i<WORD_LENGTH;i++){
    setTimeout(()=>{
      row[i].classList.add("flip");
      row[i].classList.remove("filled");
      row[i].classList.add(states[i]);
      setTimeout(()=>row[i].classList.remove("flip"),500);
    },i*100);
  }
  if(currentGuess.toLowerCase()===targetWord){
    gameOver=true;
    finalizeGame("win");
    setTimeout(()=>{
      document.getElementById("message").textContent="You won!";
      document.getElementById("new-game-btn").style.display="block";
    },600);
  }else if(currentRow===MAX_GUESSES-1){
    gameOver=true;
    finalizeGame("loss");
    setTimeout(()=>{
      document.getElementById("message").textContent=`You lost! The word was ${targetWord.toUpperCase()}`;
      document.getElementById("new-game-btn").style.display="block";
    },600);
  }else{
    currentRow++;
    currentGuess="";
  }
}

function handleKeyInput(key){
  if(gameOver){
    if(key==="ENTER"){
      initGame();
    }
    return;
  }
  if(key==="BACKSPACE"){
    if(currentGuess.length>0){
      currentGuess=currentGuess.slice(0,-1);
      updateBoard();
    }
  }else if(key==="ENTER"){
    if(currentGuess.length===WORD_LENGTH){
      submitGuess();
    }
  }else if(key.length===1&&key>="A"&&key<="Z"&&currentGuess.length<WORD_LENGTH){
    currentGuess+=key;
    updateBoard();
  }
}

document.addEventListener("keydown",(e)=>{
  if(e.key==="Enter"||e.key==="Backspace"){
    if(e.key==="Enter"){
      handleKeyInput("ENTER");
    }else if(e.key==="Backspace"){
      handleKeyInput("BACKSPACE");
    }
  }else if(e.key.length===1&&e.key>="a"&&e.key<="z"){
    handleKeyInput(e.key.toUpperCase());
  }
});

document.querySelectorAll(".keyboard-key").forEach(key=>{
  key.addEventListener("click",()=>{
    const keyValue=key.dataset.key;
    if(keyValue==="BACKSPACE"){
      handleKeyInput("BACKSPACE");
    }else if(keyValue==="ENTER"){
      handleKeyInput("ENTER");
    }else{
      handleKeyInput(keyValue);
    }
  });
});

document.getElementById("new-game-btn").addEventListener("click",initGame);
window.addEventListener("online",()=>{
  syncRetryMs=2000;
  trySyncPendingGames();
});

if(IS_NATIVE_APP){
  setOfflineStatus("Native offline mode active","#86efac");
}else if("serviceWorker" in navigator){
  navigator.serviceWorker.addEventListener("message",(event)=>{
    if(event.data?.type==="sw-pong"){
      const enabled=getOfflineShellPreference();
      if(enabled){
        setOfflineStatus(`Offline shell beta active (${event.data.version})`,"#86efac");
      }else{
        setOfflineStatus(`Diagnostics mode active (${event.data.version})`,"#fbbf24");
      }
    }else if(event.data?.type==="offline-shell-mode-updated"){
      if(event.data.enabled){
        setOfflineStatus("Offline shell beta enabled for this device","#86efac");
        checkOfflineReadyStatus();
      }else{
        setOfflineStatus("Diagnostics mode active (offline shell disabled)","#fbbf24");
      }
    }
  });

  window.addEventListener("load",async()=>{
    try{
      if("caches" in window){
        const cacheKeys=await caches.keys();
        const legacyCacheKeys=cacheKeys.filter(key=>key.startsWith("wordle-cache-"));
        await Promise.all(legacyCacheKeys.map(key=>caches.delete(key)));
      }

      const registration=await navigator.serviceWorker.register("/sw.js");
      await navigator.serviceWorker.ready;
      const offlineShellEnabled=getOfflineShellPreference();
      const notifyTargets=[
        navigator.serviceWorker.controller,
        registration.active,
        registration.waiting,
        registration.installing
      ].filter(Boolean);
      notifyTargets.forEach(worker=>{
        worker.postMessage({type:"set-offline-shell-mode",enabled:offlineShellEnabled});
        worker.postMessage({type:"sw-ping"});
      });
      if(offlineShellEnabled){
        setOfflineStatus("Enabling offline shell beta for this device...","#86efac");
      }else{
        setOfflineStatus("Diagnostics mode active (offline shell disabled)","#fbbf24");
      }
    }catch(error){
      setOfflineStatus("Diagnostics mode failed; refresh once","#f87171");
    }
  });
}else{
  setOfflineStatus("Offline ready: service worker not supported","#f87171");
}

initGame();
trySyncPendingGames();
</script>
</body>
</html>